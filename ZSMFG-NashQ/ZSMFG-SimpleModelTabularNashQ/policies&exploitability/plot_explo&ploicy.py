import numpy as np
import matplotlib.pyplot as plt


npzfile = np.load("ZSMFG-NashQ/ZSMFG-SimpleModelTabularNashQ/policies&exploitability/evaluation_100steps.npz")
evol_recover_1= npzfile['evolution_recover'][:,0]
evol_recover_2= npzfile['evolution_recover'][:,1]

evol_expo_1 =    npzfile['evolution_expo_1']
evol_expo_2 = npzfile['evolution_expo_2']

reward_recover_1 = npzfile['reward_1_episode']
reward_recover_2 = npzfile['reward_2_episode']

reward_expo_1 = npzfile["explo_value_1"]
reward_expo_2 = npzfile["explo_value_2"]

#n_steps_ctrl =  npzfile['n_steps_ctrl']
steps =         [i for i in range(1,102)]
# Q_1_diff_sup  =    np.log(npzfile['Q_1_diff_sup'])
# Q_1_diff_L2  =    np.log(npzfile['Q_1_diff_L2'])
# Q_2_diff_sup  =    np.log(npzfile['Q_2_diff_sup'])
# Q_2_diff_L2  =    np.log(npzfile['Q_2_diff_L2'])
if __name__ == "__main__":
    #print(Q_1.shape)
    print(np.average(reward_recover_1))
    print(np.average(reward_expo_1))

    print(np.average(reward_recover_2))
    print(np.average(reward_expo_2))
    # plt.clf()
    # plt.plot(steps,reward_recover_1 , label='r_1_recover',marker='o')
    # plt.plot(steps,reward_recover_2, label='r_2_recover',marker='s')

    # plt.plot(steps,reward_expo_1, label='r_1_expo',marker='d')
    # plt.plot(steps,reward_expo_2, label='r_2_expo',marker='x')

    plt.plot(steps,evol_recover_1[:,0] , label='m_1_recover',marker='o')
    plt.plot(steps,evol_recover_1[:,1] , label='m_2_recover',marker='s')
    plt.plot(steps,evol_recover_1[:,2], label='m_3_recover',marker='^')

    plt.plot(steps,evol_expo_1[:,0] , label='m_1_expo',marker='d')
    plt.plot(steps,evol_expo_1[:,1] , label='m_2_expo',marker='x')
    plt.plot(steps,evol_expo_1[:,2], label='m_3_expo',marker='*')
    # plt.plot(steps,evol_recover_2[:,0] , label='m_1_recover',marker='o')
    # plt.plot(steps,evol_recover_2[:,1] , label='m_2_recover',marker='s')
    # plt.plot(steps,evol_recover_2[:,2], label='m_3_recover',marker='^')

    # plt.plot(steps,evol_expo_2[:,0] , label='m_1_expo',marker='d')
    # plt.plot(steps,evol_expo_2[:,1] , label='m_2_expo',marker='x')
    # plt.plot(steps,evol_expo_2[:,2], label='m_3_expo',marker='*')

    #plt.plot(iters, Q_2_diff_sup, label='Q_2_diff_sup',linestyle="--")
    #plt.plot(iters, Q_2_diff_L2, label='Q_2_diff_L2',color="black", linestyle="--")
    plt.xlabel('steps')
    plt.ylabel('Evolution')
    plt.legend()
    plt.title("Evolution of Player 1's population")
    #plt.title("Reward and Exploitability Value of player1 and player2's population")
    plt.savefig("ZSMFG-NashQ/ZSMFG-SimpleModelTabularNashQ/policies&exploitability/evolution_player1.eps")